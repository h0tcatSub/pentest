var cashlessCharge = {
	/**
	 * 謾ｯ謇輔＞譁ｹ豕戊ｨｭ螳哂PI蜻ｼ縺ｳ蜃ｺ縺�
	 *
	 * @param tradeCd 蜿門ｼ輔さ繝ｼ繝�
	 * @param json 繝ｪ繧ｯ繧ｨ繧ｹ繝医�繝�ぅ
	 * @returns
	 */
	callSetPaymentTypeAPI : function(tradeCd, json) {
		// 繝ｭ繝ｼ繝我ｸｭ縺ｮ逕ｻ蜒剰｡ｨ遉ｺ
		let loading = '<div class="spinner-border center-block mx-auto loading" role="status"><span class="sr-only">Loading...</span></div>';
		$("#confirmBtn").prop("disabled", true);
		this.showMessageModal(loading);
		// PayPay隱崎ｨｼ蜃ｦ逅�ｾ後�隱崎ｨｼ邨先棡蜿門ｾ励↓譎る俣縺梧寺縺九ｋ蝣ｴ蜷医′縺ゅｋ轤ｺ縲√Γ繝�そ繝ｼ繧ｸ繧定｡ｨ遉ｺ縺吶ｋ
		if(json.is_paypay_auth_flg == '1'){
			$('#loadingComment').html('窶ｻ蜃ｦ逅�↓譎る俣縺後°縺九ｋ蝣ｴ蜷医′縺斐＊縺�∪縺吶ゅ◎縺ｮ縺ｾ縺ｾ縺ｧ縺雁ｾ�■縺上□縺輔＞縲�<br /> <br />');
			$("#loadingComment").show();
		} else {
			$("#loadingComment").hide();
		}
		common.executeApi(PROPERTY.API_CASHLESS_SELECT_URL + '?trade_cd=' + tradeCd, json, 'httpPutApiCall', 'POST')
		.done(function (data, textStatus, jqXHR) {
			console.log("done");
			$(".loading").fadeOut();
			$("#loadingComment").fadeOut();
			$("#confirmModal").modal("hide");
			$("#confirmBtn").prop("disabled", false);
			let resultCd = jqXHR.responseJSON.result.result_cd;
			let retryLimitCnt = jqXHR.responseJSON.result.retry_limit_cnt;
			// 謇狗ｶ壼ｮ御ｺ�Δ繝ｼ繝繝ｫ繧定｡ｨ遉ｺ縺吶ｋ
			if (resultCd == "1") {
				if (json.charge_kbn == "06"){
					$("#completePaypayMsg").show();
				} else {
					$("#completePaypayMsg").hide();
				}
				$("#completeModal").modal("show");
				// 繝ｪ繝医Λ繧､繝｢繝ｼ繝繝ｫ繧定｡ｨ遉ｺ縺吶ｋ
			} else if (resultCd == "2") {
				$("#retryCnt").text(retryLimitCnt);
				// Kyash縺ｮ蝣ｴ蜷医�繝｡繝�そ繝ｼ繧ｸ繧定｡ｨ遉ｺ
				if (json.charge_kbn == "04"){
					$('#retryKyashMsg').html('窶ｻ雋ｷ蜿紋ｻ｣驥代′5荳��繧定ｶ�∴縺ｦ縺�ｋ蝣ｴ蜷医゜yash繧｢繝励Μ縺ｮ譛ｬ莠ｺ遒ｺ隱阪′縺ｧ縺阪※縺�↑縺�庄閭ｽ諤ｧ縺後≠繧翫∪縺吶�');
					$("#retryKyashMsg").show();
				} else {
					$("#retryKyashMsg").hide();
				}
				$("#retryModal").modal("show");
			// 雋ｷ蜿悶�繧､繝ｳ繝亥�繧頑崛縺医Δ繝ｼ繝繝ｫ繧定｡ｨ遉ｺ縺吶ｋ
			} else if (resultCd == "3") {
				$("#errorModal").modal("show");
			// PayPay隱崎ｨｼ蜃ｦ逅�悴螳滓命&隱崎ｨｼ繧ｨ繝ｩ繝ｼ縺ｮ蝣ｴ蜷医�PayPay隱崎ｨｼ蜃ｦ逅�↓騾ｲ繧
			} else if (json.is_paypay_auth_flg != '1' && (resultCd == "5" || resultCd == "6")) {
				cashlessCharge.redirectPayPayAuth(tradeCd);
			// PayPay隱崎ｨｼ蜃ｦ逅�ｾ後↓譛ｪ隱崎ｨｼ繧ｨ繝ｩ繝ｼ縺ｮ蝣ｴ蜷医�隱崎ｨｼ蜃ｦ逅�ｸｭ繝｢繝ｼ繝繝ｫ繧定｡ｨ遉ｺ縺吶ｋ
			} else if (json.is_paypay_auth_flg == '1' && resultCd == "5") {
				$("#authenticatingModal").modal("show");
			// PayPay隱崎ｨｼ蜃ｦ逅�ｾ後↓隱崎ｨｼ繧ｨ繝ｩ繝ｼ縺ｮ蝣ｴ蜷医�隱崎ｨｼ繧ｨ繝ｩ繝ｼ繝｢繝ｼ繝繝ｫ繧定｡ｨ遉ｺ縺吶ｋ
			} else if (json.is_paypay_auth_flg == '1' && resultCd == "6") {
				$("#authFailedModal").modal("show");
			// 萓句､悶お繝ｩ繝ｼ繝｢繝ｼ繝繝ｫ繧定｡ｨ遉ｺ縺吶ｋ
			} else {
				$("#exceptionModal").modal("show");
			}
		}).fail(function (jqXHR, textStatus, errorThrown) {
			console.log("fail");
			// 繝｢繝ｼ繝繝ｫ繧偵け繝ｭ繝ｼ繧ｺ縺励√お繝ｩ繝ｼ繝｡繝�そ繝ｼ繧ｸ繧定｡ｨ遉ｺ縺吶ｋ
			$(".loading").fadeOut();
			$("#loadingComment").fadeOut();
			$("#confirmModal").modal("hide");
			$('body, html').animate({ scrollTop: 0 });
			$("#confirmBtn").prop("disabled", false);
			let errCd = jqXHR.responseJSON.result.err_cd;
			let msg = jqXHR.responseJSON.result.msg;
			if(errCd == "E2006"){
				cashlessCharge.showMessage(MESSAGE_CONST.E2006 + "<br>");
			}else{
				cashlessCharge.showMessage(MESSAGE_CONST.E0000 + "<br>");
			}
	    });
	},

	/**
	 * 繝､繝槭ヨ縺ｮPayPay隱崎ｨｼ蜃ｦ逅�判髱｢縺ｫ驕ｷ遘ｻ縺吶ｋ縲�
	 * 窶ｻ逕ｻ髱｢驕ｷ遘ｻ譎ゅ�繝ｪ繧ｯ繧ｨ繧ｹ繝磯��岼荳肴ｭ｣縺ｯ繝､繝槭ヨ縺ｮ繧ｷ繧ｹ繝�Β繧ｨ繝ｩ繝ｼ逕ｻ髱｢縺ｧ邨ゆｺ�
	 */
	redirectPayPayAuth : function(tradeCd) {
		const RE_URL = PROPERTY.SELECTPAYMENT_BASE_URL + tradeCd + '&' + 'auth_result=';
		const SUCCEEDED = RE_URL + PROPERTY.RE_PARAM_SUCCEEDED;
		const DECLINED = RE_URL + PROPERTY.RE_PARAM_DECLINED;
		const BAD_REQUEST = RE_URL + PROPERTY.RE_PARAM_BADREQUEST;
		$('#paypay_auth_form').attr({action: PROPERTY.API_YAMATO_PAYPAYAUTH_URL, method: 'POST'})
		.append($('<input/>', {type: 'hidden', name: 'MEMBER_STORE_ID', value: PROPERTY.API_YAMATO_ID}))
		.append($('<input/>', {type: 'hidden', name: 'UAID_URL', value: PROPERTY.API_CASHLESS_PAYPAYAUTHINFO_URL}))
		.append($('<input/>', {type: 'hidden', name: 'RE_URL_SUCCEEDED', value: SUCCEEDED}))
		.append($('<input/>', {type: 'hidden', name: 'RE_URL_DECLINED', value: DECLINED}))
		.append($('<input/>', {type: 'hidden', name: 'RE_URL_BADREQUEST', value: BAD_REQUEST}))
		.submit();
	},

	/**
	 * 繝｡繝�そ繝ｼ繧ｸ陦ｨ遉ｺ
	 * @param msg
	 */
	showMessage : function(msg) {
		$('.msg-txt').html(msg);
		$('.msg-txt').show();
	},

	/**
	 * 繝｢繝ｼ繝繝ｫ繧定｡ｨ遉ｺ縺吶ｋ
	 * @param msg
	 */
	showMessageModal : function(msg) {
		$('.confirm-msg-txt').html(msg);
		$('.confirm-msg-txt').show();
	},

	/**
	 * 驕ｸ謚槭＠縺滓髪謇墓婿豕輔ｒ謾ｯ謇墓婿豕慕｢ｺ隱阪Δ繝ｼ繝繝ｫ縺ｫ險ｭ螳壹☆繧�
	 */
	setConfirmModalText : function() {
		let checkedLine = $("input[name='radioGroup']:checked").parents("tr");
	    let paymentMtd = $(checkedLine.find("label")[0]).text();
	    let amount = 88888888
	    let rcv = checkedLine.find(".rcv").text() + checkedLine.find(".modalFeeMsg").text();
	    $("#paymentMtd").text(paymentMtd);
	    $("#amount").text(amount);
	    $("#rcv").text(rcv);
	}
};
